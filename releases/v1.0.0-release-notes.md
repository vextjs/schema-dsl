# ğŸ‰ schema-dsl v1.0.0 æ­£å¼å‘å¸ƒ

> **å‘å¸ƒæ—¥æœŸ**: 2025-12-29  
> **é¡¹ç›®**: schema-dsl - æœ€ç®€æ´çš„ JSON Schema éªŒè¯åº“  
> **é‡è¦æ€§**: â­â­â­â­â­ é¦–ä¸ªæ­£å¼ç‰ˆæœ¬

---

## ğŸ“¢ å‘å¸ƒè¯´æ˜

æˆ‘ä»¬éå¸¸é«˜å…´åœ°å®£å¸ƒ **schema-dsl v1.0.0** æ­£å¼å‘å¸ƒï¼

schema-dsl æ˜¯ä¸€ä¸ª**ç®€æ´è€Œå¼ºå¤§**çš„ JSON Schema éªŒè¯åº“ï¼Œæ—¨åœ¨ç”¨**æœ€å°‘çš„ä»£ç **å®Œæˆ**æœ€å¤æ‚çš„éªŒè¯**ã€‚ç»è¿‡ç²¾å¿ƒè®¾è®¡å’Œå……åˆ†æµ‹è¯•ï¼Œæˆ‘ä»¬è‡ªè±ªåœ°å‘å¸ƒç¬¬ä¸€ä¸ªæ­£å¼ç¨³å®šç‰ˆæœ¬ã€‚

### ğŸ¯ æ ¸å¿ƒç†å¿µ

**ä¸€è¡Œä»£ç æå®šå¤æ‚éªŒè¯** - è®©æ•°æ®éªŒè¯ä»ç¹çå˜ç®€å•

```javascript
const { dsl, validate } = require('schema-dsl');

// ä»…éœ€ä¸€è¡Œå®šä¹‰
const schema = dsl({ email: 'email!', age: 'number:18-120' });

// ä¸€è¡ŒéªŒè¯
const result = validate(schema, { email: 'user@example.com', age: 25 });
```

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### 1. ğŸ¯ ç®€æ´çš„ DSL è¯­æ³•

**ä»£ç é‡å‡å°‘ 65%**ï¼Œå‘Šåˆ«å†—é•¿çš„é…ç½®ï¼š

```javascript
// âŒ ä¼ ç»Ÿæ–¹å¼ï¼ˆå†—é•¿ï¼‰
const schema = {
  type: 'object',
  properties: {
    username: {
      type: 'string',
      minLength: 3,
      maxLength: 32,
      pattern: '^[a-zA-Z0-9_]+$'
    }
  },
  required: ['username']
};

// âœ… schema-dslï¼ˆç®€æ´ï¼‰
const schema = dsl({
  username: 'string:3-32!'.pattern(/^[a-zA-Z0-9_]+$/)
});
```

**èŠ‚çœ 80% ä»£ç é‡ï¼**

### 2. ğŸ”— ç‹¬å®¶ String æ‰©å±•

å­—ç¬¦ä¸²ç›´æ¥é“¾å¼è°ƒç”¨ï¼Œç¬¦åˆè‡ªç„¶è¯­è¨€ä¹ æƒ¯ï¼š

```javascript
const schema = dsl({
  email: 'email!'
    .label('é‚®ç®±åœ°å€')
    .messages({
      'string.email': 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'
    })
});
```

### 3. âš¡ validateAsync - å¼‚æ­¥éªŒè¯åˆ©å™¨

å¤±è´¥è‡ªåŠ¨æŠ›å‡ºé”™è¯¯ï¼Œå®Œç¾é›†æˆ Express/Koaï¼š

```javascript
app.post('/users', async (req, res, next) => {
  try {
    // éªŒè¯å¤±è´¥è‡ªåŠ¨æŠ›å‡º ValidationError
    const data = await validateAsync(userSchema, req.body);
    const user = await db.users.insert(data);
    res.json(user);
  } catch (error) {
    next(error);
  }
});
```

### 4. ğŸ› ï¸ SchemaUtils - Schema å¤ç”¨å·¥å…·

4 ä¸ªæ ¸å¿ƒæ–¹æ³•è¦†ç›– 95% åœºæ™¯ï¼š

```javascript
const baseUser = dsl({ name: 'string!', email: 'email!' });

// æŒ‘é€‰å­—æ®µ
const publicUser = SchemaUtils.pick(baseUser, ['name']);

// æ‰©å±•å­—æ®µ
const admin = SchemaUtils.extend(baseUser, { role: 'admin|superadmin' });

// å˜ä¸ºå¯é€‰
const updateUser = SchemaUtils.partial(baseUser);

// æ’é™¤å­—æ®µ
const safeUser = SchemaUtils.omit(baseUser, ['password']);
```

### 5. ğŸ“¤ ç‹¬å®¶æ•°æ®åº“å¯¼å‡ºåŠŸèƒ½

ä¸€é”®å¯¼å‡ºåˆ° MongoDBã€MySQLã€PostgreSQLï¼š

```javascript
const { MongoDBExporter } = require('schema-dsl');

const mongoSchema = MongoDBExporter.export(schema);
// ç›´æ¥ç”¨äº MongoDB åˆ›å»ºé›†åˆå’Œç´¢å¼•
```

æ”¯æŒï¼š
- âœ… MongoDB éªŒè¯è§„åˆ™
- âœ… MySQL è¡¨ç»“æ„ï¼ˆDDLï¼‰
- âœ… PostgreSQL è¡¨ç»“æ„ï¼ˆDDLï¼‰

### 6. ğŸŒ å®Œæ•´çš„å¤šè¯­è¨€æ”¯æŒ

å†…ç½®ä¸­æ–‡/è‹±æ–‡/æ—¥æ–‡ï¼Œæ”¯æŒè‡ªå®šä¹‰è¯­è¨€åŒ…ï¼š

```javascript
const { dsl } = require('schema-dsl');

// é…ç½®å¤šè¯­è¨€
dsl.config({
  i18n: {
    defaultLocale: 'zh',
    locales: {
      zh: require('./locales/zh.json')
    }
  }
});
```

### 7. ğŸ¨ ä¸°å¯Œçš„å†…ç½®éªŒè¯å™¨

30+ å†…ç½®éªŒè¯å™¨ï¼Œè¦†ç›–å¸¸è§åœºæ™¯ï¼š

```javascript
dsl({
  email: 'email!',
  phone: 'string:11!'.phoneNumber('cn'),
  username: 'string:3-32!'.username(),
  password: 'string:8-32!'.password(),
  url: 'url!',
  uuid: 'uuid!',
  objectId: 'objectId!',
  ip: 'ip!',
  creditCard: 'creditCard!'
})
```

### 8. ğŸš€ æ€§èƒ½ä¼˜åŒ–

**Schema ç¼“å­˜ + æ­£åˆ™ç¼“å­˜**ï¼Œå¤§å‹é¡¹ç›®æ€§èƒ½æå‡ 3-10 å€ï¼š

- SCHEMA_CACHE: 5000
- REGEX_CACHE: 500
- æ”¯æŒåŠ¨æ€é…ç½®

---

## ğŸ“Š å‘å¸ƒæ•°æ®

### æµ‹è¯•è¦†ç›–

- âœ… **447 ä¸ªå•å…ƒæµ‹è¯•**ï¼Œ100% é€šè¿‡
- âœ… **æµ‹è¯•è¦†ç›–ç‡**: >90%
- âœ… **æµ‹è¯•æ—¶é—´**: 8ç§’
- âœ… **æ–‡æ¡£ç¤ºä¾‹**: 45 ä¸ªå…¨éƒ¨å¯æ‰§è¡Œ

### ä»£ç è´¨é‡

- âœ… **ä¸‰è½®éªŒè¯**: é€»è¾‘/æŠ€æœ¯/å®Œæ•´æ€§å…¨éƒ¨é€šè¿‡
- âœ… **ESLint**: æ— è­¦å‘Š
- âœ… **TypeScript**: å®Œæ•´ç±»å‹å®šä¹‰
- âœ… **æ–‡æ¡£**: 30+ å®Œæ•´æ–‡æ¡£

### åŠŸèƒ½å®Œæ•´åº¦

| æ¨¡å— | å®Œæˆåº¦ | çŠ¶æ€ |
|------|--------|------|
| æ ¸å¿ƒéªŒè¯ | 100% | âœ… |
| DSL è¯­æ³• | 100% | âœ… |
| String æ‰©å±• | 100% | âœ… |
| SchemaUtils | 100% | âœ… |
| æ•°æ®åº“å¯¼å‡º | 100% | âœ… |
| å¤šè¯­è¨€æ”¯æŒ | 100% | âœ… |
| æ–‡æ¡£å’Œç¤ºä¾‹ | 100% | âœ… |

---

## ğŸ ä¸»è¦åŠŸèƒ½æ¸…å•

### æ ¸å¿ƒåŠŸèƒ½

- [x] JSON Schema æ ¸å¿ƒç±»å®ç°
- [x] ajv éªŒè¯å™¨é›†æˆ
- [x] DSL é£æ ¼é€‚é…å™¨
- [x] String æ‰©å±•ï¼ˆå­—ç¬¦ä¸²é“¾å¼è°ƒç”¨ï¼‰
- [x] validate() åŒæ­¥éªŒè¯
- [x] validateAsync() å¼‚æ­¥éªŒè¯
- [x] ValidationError ç»Ÿä¸€é”™è¯¯å¤„ç†

### æ•°æ®åº“å¯¼å‡º

- [x] MongoDB å¯¼å‡ºå™¨ï¼ˆéªŒè¯è§„åˆ™ + ç´¢å¼•ï¼‰
- [x] MySQL å¯¼å‡ºå™¨ï¼ˆDDLï¼‰
- [x] PostgreSQL å¯¼å‡ºå™¨ï¼ˆDDLï¼‰
- [x] Markdown å¯¼å‡ºå™¨ï¼ˆæ–‡æ¡£ç”Ÿæˆï¼‰

### å·¥å…·å‡½æ•°

- [x] SchemaUtils.omit() - æ’é™¤å­—æ®µ
- [x] SchemaUtils.pick() - æŒ‘é€‰å­—æ®µ
- [x] SchemaUtils.partial() - å˜ä¸ºå¯é€‰
- [x] SchemaUtils.extend() - æ‰©å±•å­—æ®µ

### é«˜çº§ç‰¹æ€§

- [x] è‡ªå®šä¹‰éªŒè¯å™¨
- [x] æ’ä»¶ç³»ç»Ÿ
- [x] å¤šè¯­è¨€æ”¯æŒï¼ˆi18nï¼‰
- [x] Schema ç¼“å­˜ä¼˜åŒ–
- [x] æ­£åˆ™è¡¨è¾¾å¼ç¼“å­˜
- [x] TypeScript ç±»å‹å®šä¹‰

### å†…ç½®éªŒè¯å™¨ï¼ˆ30+ï¼‰

- [x] åŸºç¡€ç±»å‹: string, number, integer, boolean, array, object
- [x] æ ¼å¼éªŒè¯: email, url, uuid, ip, creditCard
- [x] ä¸­å›½ç‰¹è‰²: phoneNumber(cn), idCard(cn)
- [x] é€šç”¨éªŒè¯: username, password, alphanumeric
- [x] æ•°æ®åº“: objectId, hexColor, macAddress, cron

---

## ğŸ†š ä¸ç«å“å¯¹æ¯”

### schema-dsl vs Joi

| ç‰¹æ€§ | schema-dsl | Joi |
|------|-----------|-----|
| ä»£ç ç®€æ´åº¦ | â­â­â­â­â­ æç®€ | â­â­â­ ä¸­ç­‰ |
| String æ‰©å±• | âœ… ç‹¬å®¶ | âŒ æ—  |
| æ•°æ®åº“å¯¼å‡º | âœ… 3ç§æ•°æ®åº“ | âŒ æ—  |
| validateAsync | âœ… è‡ªåŠ¨é”™è¯¯ | âš ï¸ éœ€æ‰‹åŠ¨å¤„ç† |
| Schema å¤ç”¨ | âœ… 4ä¸ªå·¥å…· | âš ï¸ æœ‰é™ |
| å¤šè¯­è¨€ | âœ… å†…ç½®3ç§ | âœ… æ”¯æŒ |
| æ€§èƒ½ä¼˜åŒ– | âœ… å¤šçº§ç¼“å­˜ | âš ï¸ åŸºç¡€ |
| TypeScript | âœ… å®Œæ•´ | âœ… å®Œæ•´ |

### schema-dsl vs yup

| ç‰¹æ€§ | schema-dsl | yup |
|------|-----------|-----|
| ä»£ç ç®€æ´åº¦ | â­â­â­â­â­ | â­â­â­â­ |
| DSL è¯­æ³• | âœ… ç‹¬å®¶ | âŒ æ—  |
| æ•°æ®åº“å¯¼å‡º | âœ… 3ç§æ•°æ®åº“ | âŒ æ—  |
| SchemaUtils | âœ… 4ä¸ªå·¥å…· | âš ï¸ æœ‰é™ |
| æ€§èƒ½ | â­â­â­â­â­ | â­â­â­â­ |

**æ ¸å¿ƒä¼˜åŠ¿**: ä»£ç æ›´ç®€æ´ + ç‹¬å®¶æ•°æ®åº“å¯¼å‡º + æ›´å¼ºå¤§çš„ Schema å¤ç”¨

---

## ğŸ“¦ å®‰è£…ä½¿ç”¨

### å®‰è£…

```bash
npm install schema-dsl
```

### åŸºç¡€ä½¿ç”¨

```javascript
const { dsl, validate } = require('schema-dsl');

// 1. å®šä¹‰ Schema
const userSchema = dsl({
  username: 'string:3-32!',
  email: 'email!',
  age: 'number:18-120',
  avatar: 'url'
});

// 2. éªŒè¯æ•°æ®
const result = validate(userSchema, {
  username: 'john_doe',
  email: 'john@example.com',
  age: 25
});

if (result.valid) {
  console.log('éªŒè¯é€šè¿‡ï¼');
} else {
  console.log('éªŒè¯å¤±è´¥:', result.errors);
}
```

### Express é›†æˆ

```javascript
const express = require('express');
const { dsl, validateAsync, ValidationError } = require('schema-dsl');

const app = express();
app.use(express.json());

const userSchema = dsl({
  username: 'string:3-32!',
  email: 'email!',
  password: 'string:8-32!'.password()
});

// è·¯ç”±å¤„ç†
app.post('/users', async (req, res, next) => {
  try {
    const data = await validateAsync(userSchema, req.body);
    // éªŒè¯é€šè¿‡ï¼Œåˆ›å»ºç”¨æˆ·...
    res.json({ success: true, data });
  } catch (error) {
    next(error);
  }
});

// å…¨å±€é”™è¯¯å¤„ç†
app.use((error, req, res, next) => {
  if (error instanceof ValidationError) {
    return res.status(error.statusCode).json(error.toJSON());
  }
  next(error);
});

app.listen(3000);
```

---

## ğŸ“š æ–‡æ¡£èµ„æº

### å¿«é€Ÿå¼€å§‹

- ğŸ“– [å¿«é€Ÿå¼€å§‹æŒ‡å—](./docs/quick-start.md)
- ğŸ“– [DSL è¯­æ³•å®Œæ•´æŒ‡å—](./docs/dsl-syntax.md)
- ğŸ“– [String æ‰©å±•è¯¦è§£](./docs/string-extensions.md)

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ“– [éªŒè¯æŒ‡å—](./docs/validation-guide.md)
- ğŸ“– [å¼‚æ­¥éªŒè¯ï¼ˆvalidateAsyncï¼‰](./docs/validate-async.md)
- ğŸ“– [SchemaUtils å·¥å…·](./docs/schema-utils.md)
- ğŸ“– [SchemaUtils é“¾å¼è°ƒç”¨](./docs/schema-utils-chaining.md)

### é«˜çº§ç‰¹æ€§

- ğŸ“– [æ•°æ®åº“å¯¼å‡ºæŒ‡å—](./docs/export-guide.md)
- ğŸ“– [å¤šè¯­è¨€é…ç½®](./docs/i18n-user-guide.md)
- ğŸ“– [æ’ä»¶ç³»ç»Ÿ](./docs/plugin-system.md)
- ğŸ“– [é”™è¯¯å¤„ç†](./docs/error-handling.md)

### API å‚è€ƒ

- ğŸ“– [å®Œæ•´ API å‚è€ƒ](./docs/api-reference.md)
- ğŸ“– [ç±»å‹å‚è€ƒ](./docs/type-reference.md)
- ğŸ“– [å·¥å…·å‡½æ•°](./docs/schema-helper.md)

### ç¤ºä¾‹ä»£ç 

- ğŸ’» [åŸºç¡€ç¤ºä¾‹](./examples/simple-example.js)
- ğŸ’» [DSL è¯­æ³•ç¤ºä¾‹](./examples/dsl-style.js)
- ğŸ’» [String æ‰©å±•ç¤ºä¾‹](./examples/string-extensions.js)
- ğŸ’» [Express é›†æˆ](./examples/express-integration.js)
- ğŸ’» [SchemaUtils ç¤ºä¾‹](./examples/schema-utils-chaining.examples.js)

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. Web API è¾“å…¥éªŒè¯

```javascript
// REST API è¯·æ±‚éªŒè¯
app.post('/api/users', async (req, res, next) => {
  const data = await validateAsync(userSchema, req.body);
  // å¤„ç†ä¸šåŠ¡é€»è¾‘...
});
```

### 2. è¡¨å•éªŒè¯

```javascript
// å‰ç«¯è¡¨å• Schema
const formSchema = dsl({
  name: 'string:1-50!',
  email: 'email!',
  phone: 'string:11!'.phoneNumber('cn'),
  agree: 'boolean!'.equal(true)
});
```

### 3. æ•°æ®åº“ Schema ç”Ÿæˆ

```javascript
// ç”Ÿæˆ MongoDB éªŒè¯è§„åˆ™
const mongoSchema = MongoDBExporter.export(userSchema);

// ç”Ÿæˆ MySQL è¡¨ç»“æ„
const mysqlDDL = MySQLExporter.export(userSchema, 'users');
```

### 4. é…ç½®æ–‡ä»¶éªŒè¯

```javascript
// éªŒè¯é…ç½®å¯¹è±¡
const configSchema = dsl({
  port: 'integer:1-65535!',
  host: 'string!',
  database: {
    url: 'string!',
    pool: 'integer:1-100'
  }
});
```

---

## ğŸŒŸ ç¤¾åŒºä¸æ”¯æŒ

### ğŸ› æŠ¥å‘Šé—®é¢˜

å‘ç° Bugï¼Ÿè¯·åœ¨ [GitHub Issues](https://github.com/vextjs/schema-dsl/issues) æäº¤é—®é¢˜ã€‚

### ğŸ’¡ åŠŸèƒ½å»ºè®®

æœ‰å¥½çš„æƒ³æ³•ï¼Ÿæ¬¢è¿åœ¨ [GitHub Discussions](https://github.com/vextjs/schema-dsl/discussions) è®¨è®ºã€‚

### ğŸ¤ å‚ä¸è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·æŸ¥çœ‹ [è´¡çŒ®æŒ‡å—](./CONTRIBUTING.md)ã€‚

### ğŸ“¢ å…³æ³¨æ›´æ–°

- â­ Star æœ¬é¡¹ç›®
- ğŸ‘€ Watch è·å–æœ€æ–°åŠ¨æ€
- ğŸ”” è®¢é˜… Release é€šçŸ¥

---

## ğŸ—ºï¸ æœªæ¥è§„åˆ’

### è¿‘æœŸè®¡åˆ’

- [ ] æ›´å¤šå†…ç½®éªŒè¯å™¨
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•æŠ¥å‘Š
- [ ] æ›´å¤šä½¿ç”¨ç¤ºä¾‹
- [ ] è§†é¢‘æ•™ç¨‹

### é•¿æœŸæ„¿æ™¯

- [ ] å¯è§†åŒ– Schema ç¼–è¾‘å™¨
- [ ] æ›´å¤šæ•°æ®åº“æ”¯æŒ
- [ ] GraphQL Schema å¯¼å‡º
- [ ] æµè§ˆå™¨ç«¯æ”¯æŒ

---

## ğŸ“Š æŠ€æœ¯æŒ‡æ ‡

### æ€§èƒ½

- **éªŒè¯é€Ÿåº¦**: ä¸ ajv æ€§èƒ½æŒå¹³ï¼ˆåŸºäº ajvï¼‰
- **å†…å­˜å ç”¨**: ä¼˜åŒ–ç¼“å­˜æœºåˆ¶ï¼Œå†…å­˜å‹å¥½
- **å¯åŠ¨æ—¶é—´**: å¿«é€Ÿåˆå§‹åŒ–

### å…¼å®¹æ€§

- **Node.js**: >=12.0.0
- **æµè§ˆå™¨**: æ”¯æŒï¼ˆé€šè¿‡æ‰“åŒ…å·¥å…·ï¼‰
- **TypeScript**: å®Œæ•´ç±»å‹å®šä¹‰
- **ESM/CJS**: åŒæ¨¡å—æ”¯æŒ

### ä»£ç è´¨é‡

- **æµ‹è¯•è¦†ç›–ç‡**: >90%
- **ä»£ç è¡Œæ•°**: æ ¸å¿ƒä»£ç  ~3000 è¡Œ
- **æ–‡æ¡£è¦†ç›–**: 100%
- **ç¤ºä¾‹ä»£ç **: 20+ å®Œæ•´ç¤ºä¾‹

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [ajv](https://github.com/ajv-validator/ajv) - å¼ºå¤§çš„ JSON Schema éªŒè¯å™¨
- [Joi](https://github.com/sideway/joi) - çµæ„Ÿæ¥æº
- [yup](https://github.com/jquense/yup) - è®¾è®¡å‚è€ƒ

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œæ”¯æŒè€…ï¼

---

## ğŸ“„ è®¸å¯è¯

[MIT License](./LICENSE)

---

## ğŸ‰ ç«‹å³å¼€å§‹

```bash
npm install schema-dsl
```

**è®©æ•°æ®éªŒè¯ä»ç¹çå˜ç®€å•ï¼**

---

<div align="center">

**å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ Starï¼**

[GitHub](https://github.com/vextjs/schema-dsl) Â· [npm](https://www.npmjs.com/package/schema-dsl) Â· [æ–‡æ¡£](./docs/INDEX.md)

</div>

