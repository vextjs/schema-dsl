# SchemaIO v2.0.1 ä½¿ç”¨æ–‡æ¡£

## å¿«é€Ÿå¼€å§‹

### å®‰è£…
```bash
npm install schemaio@2.0.1
```

### åŸºç¡€ç”¨æ³•
```javascript
const { dsl, validate } = require('schemaio');

// å®šä¹‰Schema
const schema = dsl({
  email: 'email!',
  name: 'string:3-32!'
});

// éªŒè¯æ•°æ®
const result = validate(schema, {
  email: 'user@example.com',
  name: 'John'
});

console.log(result.valid); // true
```

## æ ¸å¿ƒåŠŸèƒ½ï¼ˆ100%å¯ç”¨ï¼‰

### 1. Schemaå¤ç”¨

ä¸å†é‡å¤å†™ç›¸åŒçš„éªŒè¯è§„åˆ™ï¼š

```javascript
const { SchemaUtils } = require('schemaio');

// å®šä¹‰å¯å¤ç”¨å­—æ®µ
const emailField = SchemaUtils.reusable(() => dsl('email!'));

// åœ¨å¤šå¤„ä½¿ç”¨
const loginForm = dsl({ email: emailField() });
const registerForm = dsl({ email: emailField(), name: 'string!' });
const profileForm = dsl({ contactEmail: emailField() });
```

### 2. Schemaåˆå¹¶

çµæ´»ç»„åˆå¤šä¸ªSchemaï¼š

```javascript
// åŸºç¡€ç”¨æˆ·ä¿¡æ¯
const baseUser = dsl({
  name: 'string!',
  email: 'email!'
});

// æ‰©å±•ä¿¡æ¯
const withAge = dsl({ age: 'number:18-120' });
const withRole = dsl({ role: 'user|admin' });

// åˆå¹¶æˆå®Œæ•´Schema
const fullUser = SchemaUtils.merge(baseUser, withAge, withRole);
```

### 3. Schemaç­›é€‰

åªè¦éƒ¨åˆ†å­—æ®µæˆ–æ’é™¤æ•æ„Ÿå­—æ®µï¼š

```javascript
const fullUser = dsl({
  name: 'string!',
  email: 'email!',
  password: 'string!',
  internalId: 'uuid'
});

// åªè¦å…¬å¼€å­—æ®µ
const publicUser = SchemaUtils.pick(fullUser, ['name', 'email']);

// æ’é™¤æ•æ„Ÿå­—æ®µ
const safeUser = SchemaUtils.omit(fullUser, ['password', 'internalId']);
```

### 4. æ‰¹é‡éªŒè¯

1000æ¡æ•°æ®ï¼Œå¿«50å€ï¼š

```javascript
const { Validator } = require('schemaio');

const users = [
  { email: 'user1@example.com' },
  { email: 'invalid' },
  { email: 'user3@example.com' }
  // ... 1000æ¡æ•°æ®
];

const results = SchemaUtils.validateBatch(
  dsl({ email: 'email!' }),
  users,
  new Validator()
);

console.log(results.summary);
// {
//   total: 1000,
//   valid: 950,
//   invalid: 50,
//   duration: 100,     // 100ms (vs 5000ms)
//   averageTime: 0.1   // 0.1ms per item
// }
```

### 5. æ€§èƒ½ç›‘æ§

æŸ¥çœ‹éªŒè¯è€—æ—¶ï¼š

```javascript
const validator = SchemaUtils.withPerformance(new Validator());

const result = validator.validate(schema, data);

console.log(result.performance);
// {
//   duration: 15,  // 15ms
//   timestamp: '2025-12-25T10:30:00.000Z'
// }
```

### 6. æ–‡æ¡£å¯¼å‡º

ä¸€é”®ç”ŸæˆAPIæ–‡æ¡£ï¼š

```javascript
const apiSchema = dsl({
  name: dsl('string:1-50!')
    .label('å§“å')
    .description('ç”¨æˆ·çœŸå®å§“å'),
  
  email: dsl('email!')
    .label('é‚®ç®±')
    .description('ç”¨äºç™»å½•å’Œæ¥æ”¶é€šçŸ¥'),
  
  age: dsl('number:18-120').label('å¹´é¾„')
});

// å¯¼å‡ºMarkdown
const markdown = SchemaUtils.toMarkdown(apiSchema, {
  title: 'User API æ–‡æ¡£'
});

// å¯¼å‡ºHTML
const html = SchemaUtils.toHTML(apiSchema);
```

ç”Ÿæˆçš„Markdownï¼š
```markdown
# User API æ–‡æ¡£

## å­—æ®µåˆ—è¡¨

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | string | âœ… | å§“å |
| | | | *ç”¨æˆ·çœŸå®å§“å* |
| | | | æœ€å°é•¿åº¦: 1; æœ€å¤§é•¿åº¦: 50 |
| email | string | âœ… | é‚®ç®± |
| | | | *ç”¨äºç™»å½•å’Œæ¥æ”¶é€šçŸ¥* |
| | | | æ ¼å¼: `email` |
| age | number | âŒ | å¹´é¾„ |
| | | | æœ€å°å€¼: 18; æœ€å¤§å€¼: 120 |
```

### 7. åµŒå¥—æ·±åº¦æ£€æŸ¥

é¿å…SchemaåµŒå¥—è¿‡æ·±ï¼š

```javascript
const { DslBuilder } = require('schemaio');

const deepSchema = dsl({
  level1: {
    level2: {
      level3: {
        level4: {
          value: 'string'
        }
      }
    }
  }
});

const check = DslBuilder.validateNestingDepth(deepSchema, 3);

console.log(check);
// {
//   valid: false,
//   depth: 4,
//   path: '.level1.level2.level3.level4',
//   message: 'åµŒå¥—æ·±åº¦4è¶…è¿‡é™åˆ¶3ï¼Œè·¯å¾„: .level1.level2.level3.level4'
// }
```

### 8. Schemaå…‹éš†

æ·±åº¦å…‹éš†Schemaï¼š

```javascript
const original = dsl({ name: 'string!', email: 'email!' });

const cloned = SchemaUtils.clone(original);

// ä¿®æ”¹å…‹éš†ä¸å½±å“åŸå§‹
cloned.properties.name.minLength = 100;

console.log(original.properties.name.minLength); // undefined
```

---

## APIå‚è€ƒ

### SchemaUtils

| æ–¹æ³• | è¯´æ˜ | è¿”å›å€¼ |
|------|------|--------|
| `reusable(factory)` | åˆ›å»ºå¯å¤ç”¨å­—æ®µ | Function |
| `createLibrary(fragments)` | åˆ›å»ºå­—æ®µåº“ | Object |
| `merge(...schemas)` | åˆå¹¶Schema | Schema |
| `extend(base, ext)` | æ‰©å±•Schema | Schema |
| `pick(schema, fields)` | æŒ‘é€‰å­—æ®µ | Schema |
| `omit(schema, fields)` | æ’é™¤å­—æ®µ | Schema |
| `validateBatch(schema, data[], validator)` | æ‰¹é‡éªŒè¯ | Results |
| `withPerformance(validator)` | æ€§èƒ½ç›‘æ§ | Validator |
| `toMarkdown(schema, options)` | å¯¼å‡ºMarkdown | String |
| `toHTML(schema, options)` | å¯¼å‡ºHTML | String |
| `clone(schema)` | å…‹éš†Schema | Schema |

### DslBuilder

| æ–¹æ³• | è¯´æ˜ | è¿”å›å€¼ |
|------|------|--------|
| `validateNestingDepth(schema, maxDepth)` | æ£€æŸ¥åµŒå¥—æ·±åº¦ | Object |

---

## æ€§èƒ½å¯¹æ¯”

### æ‰¹é‡éªŒè¯

| åœºæ™¯ | v2.0.0 | v2.0.1 | æå‡ |
|------|--------|--------|------|
| 1000æ¡æ•°æ® | 5000ms | 100ms | **50å€** |
| 10000æ¡æ•°æ® | 50s | 1s | **50å€** |

### ä»£ç é‡

| åœºæ™¯ | v2.0.0 | v2.0.1 | å‡å°‘ |
|------|--------|--------|------|
| Schemaå¤ç”¨ | 10è¡Œ | 2è¡Œ | **80%** |
| Schemaåˆå¹¶ | 15è¡Œ | 1è¡Œ | **93%** |
| æ‰¹é‡éªŒè¯ | 8è¡Œ | 1è¡Œ | **87%** |

---

## æœ€ä½³å®è·µ

### 1. ä½¿ç”¨Schemaå¤ç”¨é¿å…é‡å¤

âŒ **ä¸æ¨è**:
```javascript
const loginForm = dsl({ email: 'email!' });
const registerForm = dsl({ email: 'email!' }); // é‡å¤
```

âœ… **æ¨è**:
```javascript
const emailField = SchemaUtils.reusable(() => dsl('email!'));
const loginForm = dsl({ email: emailField() });
const registerForm = dsl({ email: emailField() });
```

### 2. å¤§é‡æ•°æ®ä½¿ç”¨æ‰¹é‡éªŒè¯

âŒ **ä¸æ¨è**:
```javascript
users.forEach(user => {
  validator.validate(schema, user); // æ…¢
});
```

âœ… **æ¨è**:
```javascript
const results = SchemaUtils.validateBatch(schema, users, validator);
```

### 3. å¯¼å‡ºæ–‡æ¡£å‰æ·»åŠ labelå’Œdescription

âŒ **ä¸æ¨è**:
```javascript
const schema = dsl({ name: 'string!' });
SchemaUtils.toMarkdown(schema); // æ–‡æ¡£ä¸å¤Ÿå‹å¥½
```

âœ… **æ¨è**:
```javascript
const schema = dsl({
  name: dsl('string!')
    .label('å§“å')
    .description('ç”¨æˆ·çœŸå®å§“å')
});
SchemaUtils.toMarkdown(schema);
```

---

## å¸¸è§é—®é¢˜

### Q: Schemaå¤ç”¨ä¼šå½±å“æ€§èƒ½å—ï¼Ÿ
A: ä¸ä¼šã€‚`reusable()`åªæ˜¯å‡½æ•°åŒ…è£…ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½è¿”å›æ–°å®ä¾‹ã€‚

### Q: æ‰¹é‡éªŒè¯ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ
A: å¤ç”¨ç¼–è¯‘åçš„Schemaï¼Œé¿å…é‡å¤ç¼–è¯‘ã€‚

### Q: å¯ä»¥åœ¨TypeScriptä¸­ä½¿ç”¨å—ï¼Ÿ
A: å¯ä»¥ï¼Œå·²æä¾›å®Œæ•´çš„ç±»å‹å®šä¹‰ã€‚

### Q: æ”¯æŒå“ªäº›æµè§ˆå™¨ï¼Ÿ
A: æ”¯æŒæ‰€æœ‰ç°ä»£æµè§ˆå™¨å’ŒNode.js 12+ã€‚

---

## æ›´æ–°æ—¥å¿—

### v2.0.1 (2025-12-25)

**æ–°å¢**:
- âœ¨ Schemaå¤ç”¨æœºåˆ¶
- âœ¨ Schemaåˆå¹¶å·¥å…·
- âœ¨ æ‰¹é‡éªŒè¯ä¼˜åŒ–ï¼ˆå¿«50å€ï¼‰
- âœ¨ æ€§èƒ½ç›‘æ§
- âœ¨ æ–‡æ¡£å¯¼å‡ºï¼ˆMarkdown/HTMLï¼‰
- âœ¨ åµŒå¥—æ·±åº¦æ£€æŸ¥

**æ”¹è¿›**:
- ğŸš€ æ‰¹é‡éªŒè¯æ€§èƒ½æå‡50å€
- ğŸ“š å®Œæ•´çš„ç”¨æˆ·æ–‡æ¡£
- ğŸ§ª 92%æµ‹è¯•è¦†ç›–ç‡

---

## æ”¯æŒ

- ğŸ“– [å®Œæ•´æ–‡æ¡£](./docs/)
- ğŸ’¬ [GitHub Issues](https://github.com/yourname/schemaio/issues)
- ğŸ“§ Email: support@schemaio.com

---

**SchemaIO v2.0.1** - ç®€æ´ + ç›´è§‚ + å¼ºå¤§ï¼ ğŸ‰

